<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>é‡çµ„å¥å­å°éŠæˆ²</title>
  <meta name="description" content="ä¸­æ–‡é‡çµ„å¥å­å°éŠæˆ²ï¼šæ•™å¸«å‡ºé¡Œã€å­¸ç”Ÿä½œç­”ã€å¤šé¡Œæ¨¡å¼ã€PIN è§£é–ã€æœ€å¾Œçµ±ä¸€è©•åˆ†ã€‚">
  <style>
    :root{--gap:10px;--radius:12px}
    *{-webkit-tap-highlight-color:transparent}
    html,body{height:100%}
    body{font-family: system-ui,-apple-system,Segoe UI,Roboto, "Noto Sans CJK TC",PingFangTC,Hiragino Sans,Arial,sans-serif; margin:18px auto; padding:0 14px; max-width:960px; line-height:1.45}
    h1{font-size:1.2rem;margin:0 0 10px}
    .card{border:1px solid #e5e5e5;border-radius:var(--radius);padding:12px;margin:10px 0;background:#fff}
    .row{display:flex;gap:var(--gap);flex-wrap:wrap;align-items:center}
    textarea{width:100%;border:1px solid #ccc;border-radius:10px;padding:10px;font-size:1rem}
    input[type="password"],input[type="text"]{border:1px solid #ccc;border-radius:10px;padding:8px 10px;font-size:.95rem}
    label{display:inline-flex;gap:8px;align-items:center;font-size:.95rem}
    button{border:0;border-radius:10px;padding:10px 14px;cursor:pointer;font-size:.95rem;touch-action:manipulation}
    button:disabled{opacity:.5;cursor:not-allowed}
    .primary{background:#2b7cff;color:#fff}
    .ghost{background:#f5f5f5}
    .tray,.answer{min-height:56px;display:flex;gap:var(--gap);flex-wrap:wrap;align-items:center;border:2px dashed #e9e9e9;border-radius:var(--radius);padding:10px;background:#fafafa}
    .tile{user-select:none;-webkit-user-select:none;-webkit-touch-callout:none;touch-action:manipulation;padding:8px 12px;border-radius:10px;background:#fff;border:1px solid #ddd;box-shadow:0 1px 0 rgba(0,0,0,.05);font-size:1.05rem}
    .tile:active{transform:scale(.98)}
    .good{background:#e9f8ee;border-color:#b7ebc6}
    .bad{background:#fff2f0;border-color:#ffccc7}
    .status{font-weight:600}
    .hint{color:#666;font-size:.9rem}
    .pill{display:inline-block;padding:2px 8px;border-radius:999px;background:#eef3ff;color:#2b55ff;font-size:.8rem;margin-left:6px}
    .hidden{display:none !important}
    /* Celebration */
    .celebration-layer{position:fixed;inset:0;pointer-events:none;overflow:hidden;z-index:60}
    .particle{position:absolute;opacity:0}
    @keyframes floatUp{0%{transform:translate(var(--x,0),10vh) scale(1);opacity:0}10%{opacity:1}100%{transform:translate(var(--x,0),-100vh) scale(1.2);opacity:0}}
    .center-pop{position:fixed;left:50%;top:40%;transform:translate(-50%,-50%) scale(.6);font-size:64px;opacity:0;z-index:61;animation:pop 900ms ease-out forwards}
    @keyframes pop{0%{transform:translate(-50%,-50%) scale(.6) rotate(-10deg);opacity:0}60%{transform:translate(-50%,-50%) scale(1.15) rotate(0);opacity:1}100%{transform:translate(-50%,-50%) scale(1);opacity:0}}
    .answer.correct-pulse{animation:glow 1200ms ease-out 1}
    @keyframes glow{0%{box-shadow:0 0 0 rgba(0,0,0,0)}30%{box-shadow:0 0 24px rgba(46,204,113,.45)}100%{box-shadow:0 0 0 rgba(0,0,0,0)}}
    .progress{height:8px;background:#f0f3ff;border-radius:999px;overflow:hidden}
    .progress>span{display:block;height:100%;background:#2b7cff;width:0%}
    /* layout tweaks */
    .toolbar{display:flex;flex-direction:column;gap:10px;margin-top:8px}
    .toolbar-row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .toolbar-row button{white-space:nowrap}
    @media (min-width:780px){.toolbar{flex-direction:column}}
    /* Modals */
    .modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.35);display:flex;align-items:center;justify-content:center;z-index:70}
    .modal{background:#fff;border-radius:14px;box-shadow:0 10px 30px rgba(0,0,0,.2);padding:16px;min-width:260px;max-width:90vw}
    .modal h3{margin:0 0 8px;font-size:1rem}
    .qitem{display:flex;gap:8px;align-items:flex-start;border:1px solid #eee;border-radius:10px;padding:8px}
    .qid{font-weight:700;min-width:3ch}
    .ans.wrong{color:#c53030}
    .ans.correct{color:#2f855a}
    #unlockBtn{position:fixed;right:14px;bottom:14px;z-index:50;border-radius:999px;padding:10px 14px}
    /* boot badge */
    #bootBadge{position:fixed;right:12px;top:12px;background:#e6ffed;color:#155724;border:1px solid #c3e6cb;border-radius:8px;padding:4px 8px;font-size:12px;z-index:9999}
    /* JS blocked notice */
    #jsBlockedNotice{background:#fff3cd;border:1px solid #ffeeba;color:#856404;padding:8px 12px;border-radius:8px;margin:10px 0}
  </style>
</head>
<body>
  <h1>é‡çµ„å¥å­å°éŠæˆ² <span class="pill">æ•™å¸«è¼¸å…¥å¥å­ / å­¸ç”Ÿä½œç­” / å¤šé¡Œæ¨¡å¼</span></h1>

  <div id="jsBlockedNotice">
    âš ï¸ è‹¥çœ‹ä¸åˆ°ã€Œ<strong>JS å·²è¼‰å…¥ âœ“</strong>ã€å¾½ç« ï¼Œä»£è¡¨ç€è¦½å™¨æœªåŸ·è¡Œ JavaScriptï¼ˆä¾‹å¦‚ iOS çš„æª”æ¡ˆé è¦½ï¼‰ã€‚è«‹ä»¥æ­£å¼ç¶²å€ï¼ˆGitHub Pages/Netlifyï¼‰é–‹å•Ÿæ­¤é ã€‚
  </div>

  <div id="bootBadge" class="hidden">JS å·²è¼‰å…¥</div>

  <!-- TEACHER PANEL -->
  <section class="card" id="teacherPanel">
    <div class="row" style="width:100%">
      <textarea id="sentences" rows="5" placeholder="ä¸€æ¬¡è¼¸å…¥å¤šé¡Œï¼šæ¯ä¸€è¡Œæ˜¯ä¸€é¡Œ
ä¾‹ï¼š
æˆ‘å€‘ ä»Šå¤© å» å…¬åœ’ ç©ã€‚
ä»Šå¤© ä¸‹é›¨ äº†ï¼Œ è¨˜å¾— å¸¶ å‚˜ã€‚
å°æ˜ å–œæ­¡ åƒ è˜‹æœã€‚"></textarea>
      <div class="hint">â€¢ ä¸€è¡Œä¸€é¡Œã€‚å¯ç”¨ç©ºæ ¼åˆ†è©ï¼ˆè©æ¨¡å¼ï¼‰ï¼Œæˆ–ä¸åŠ ç©ºæ ¼ï¼ˆæ¯å­—æ¨¡å¼ï¼‰ã€‚<br>â€¢ äº¦å¯æ··åˆï¼šæŸäº›é¡Œç”¨è©ã€æŸäº›é¡Œç”¨å­—ã€‚å…¨å±€é¸é …ä»æœƒå¥—ç”¨ã€‚</div>
    </div>
    <div class="row" style="margin-top:8px">
      <label><input type="checkbox" id="forceChar"> å¼·åˆ¶æ¯å­—ä¸€å¡Š</label>
      <label><input type="checkbox" id="excludePunct"> æ’é™¤æ¨™é»ä¸å‡ºé¡Œ</label>
    </div>
    <div class="toolbar">
      <div class="toolbar-row">
        <button type="button" class="primary" id="makeSet">å‡ºé¡Œï¼ˆå¤šé¡Œï¼‰</button>
        <button type="button" class="ghost" id="makeOne">å‡ºé¡Œï¼ˆå–®é¡Œï¼‰</button>
        <button type="button" class="ghost" id="shuffle">é‡æ’ç•¶å‰é¡Œ</button>
      </div>
      <div class="toolbar-row">
        <button type="button" class="ghost" id="clear">å…¨éƒ¨æ¸…é™¤</button>
        <button type="button" class="ghost" id="hideNow" title="å‡ºé¡Œå¾Œç«‹å³éš±è—æ•™å¸«å€">å‡ºé¡Œå¾Œéš±è—</button>
        <label style="margin-left:auto">æ•™å¸«PINï¼š<input type="password" id="pin" placeholder="å¯é¸"></label>
        <button type="button" class="ghost" id="changePin">æ›´æ”¹PIN</button>
      </div>
    </div>
  </section>

  <!-- GAME AREA -->
  <section class="card">
    <div class="row" style="width:100%">
      <div class="hint">ç¬¬ <span id="qIndex">1</span> / <span id="qTotal">1</span> é¡Œ</div>
      <div class="spacer" style="flex:1"></div>
      <div class="hint">å¾—åˆ†ï¼š<strong id="score">0</strong></div>
    </div>
    <div class="progress"><span id="progressBar"></span></div>
    <div style="margin-top:10px"><strong>æ‰“äº‚çš„å­—/è©ï¼ˆé»ä¸€ä¸‹å³å¯åŠ å…¥ç­”æ¡ˆï¼‰</strong></div>
    <div id="tray" class="tray"></div>
    <div style="margin-top:10px"><strong>ä½ çš„ç­”æ¡ˆï¼ˆé»ä¸€ä¸‹å¯ç§»å›ä¸Šé¢ï¼‰</strong></div>
    <div id="answer" class="answer"></div>
    <div class="row" style="margin-top:10px; gap:8px">
      <button type="button" class="ghost" id="prev">ä¸Šä¸€é¡Œ</button>
      <button type="button" class="ghost" id="next">ä¸‹ä¸€é¡Œ</button>
      <button type="button" class="primary" id="finishAll">äº¤å·ï¼ˆå…¨éƒ¨æª¢æŸ¥ï¼‰</button>
      <button type="button" class="ghost hidden" id="reveal" aria-hidden="true" tabindex="-1" disabled>é¡¯ç¤ºç­”æ¡ˆï¼ˆåƒ…ä¾›æ•™å¸«ä½¿ç”¨ï¼‰</button>
      <div class="status" id="result"></div>
    </div>
  </section>

  <!-- ORIGINAL (for teacher reveal) -->
  <section class="card hidden" id="originalBox">
    <div><strong>åŸå¥</strong></div>
    <div id="original" class="hint"></div>
  </section>

  <!-- Teacher unlock button + dialogs -->
  <button type="button" id="unlockBtn" class="ghost hidden" title="æ•™å¸«è§£é–">æ•™å¸«è§£é– ğŸ”’</button>

  <div id="pinBackdrop" class="modal-backdrop hidden" role="dialog" aria-modal="true" aria-labelledby="pinTitle">
    <div class="modal">
      <h3 id="pinTitle">è¼¸å…¥æ•™å¸«PIN</h3>
      <div class="row"><input id="pinInput" type="password" placeholder="æ•™å¸«PIN" style="flex:1" /></div>
      <div class="row" style="justify-content:flex-end">
        <button type="button" id="pinCancel" class="ghost">å–æ¶ˆ</button>
        <button type="button" id="pinOK" class="primary">è§£é–</button>
      </div>
      <div class="hint error" id="pinHint" style="margin-top:6px"></div>
    </div>
  </div>

  <div id="changeBackdrop" class="modal-backdrop hidden" role="dialog" aria-modal="true" aria-labelledby="changeTitle">
    <div class="modal">
      <h3 id="changeTitle">æ›´æ”¹æ•™å¸«PIN</h3>
      <div class="row"><input id="oldPinInput" type="password" placeholder="ç›®å‰PINï¼ˆæœªè¨­å®šå¯ç•™ç©ºï¼‰" style="flex:1" /></div>
      <div class="row"><input id="newPinInput" type="password" placeholder="æ–°PIN" style="flex:1" /></div>
      <div class="row"><input id="newPinInput2" type="password" placeholder="å†æ¬¡è¼¸å…¥æ–°PIN" style="flex:1" /></div>
      <div class="row" style="justify-content:flex-end">
        <button type="button" id="changeCancel" class="ghost">å–æ¶ˆ</button>
        <button type="button" id="changeOK" class="primary">æ›´æ–°</button>
      </div>
      <div class="hint" id="changeHint" style="margin-top:6px"></div>
    </div>
  </div>

  <div id="summaryBackdrop" class="modal-backdrop hidden" role="dialog" aria-modal="true" aria-labelledby="summaryTitle">
    <div class="modal" style="max-width:92vw;max-height:80vh;overflow:auto">
      <h3 id="summaryTitle">ä½œç­”ç¸½è¦½</h3>
      <div class="qlist" id="summaryList"></div>
      <div class="row" style="justify-content:flex-end;margin-top:8px">
        <button type="button" id="summaryClose" class="ghost">é—œé–‰</button>
        <button type="button" id="summaryFirstWrong" class="primary">è·³åˆ°ç¬¬ä¸€é¡ŒéŒ¯èª¤</button>
      </div>
    </div>
  </div>

  <!-- External JS only -->
  <script defer src="app.js"></script>
  <noscript><div style="padding:8px;background:#ffe8e8;color:#900">æ­¤é éœ€è¦å•Ÿç”¨ JavaScriptã€‚</div></noscript>
</body>
</html>
